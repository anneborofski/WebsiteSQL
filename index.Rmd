---
title: "SQL"
output: html_document
---

```{r message=FALSE}
library(sqldf)
library(Lahman)
```


##Filtering Columns and Row

description

Homerun totals for the 1927 Yankees.

```{r}
query<- "SELECT teamID,yearID,HR,playerID
FROM Batting
WHERE teamID='NYA' and yearID=1927"

sqldf(query)
```

Every Yankee that has hit 40 or more homeruns

```{r}
query<- "SELECT teamID,yearID,HR,playerID
FROM Batting 
WHERE teamID='NYA'and HR>=40"

sqldf(query)
```

Find an instance where a player has had more than 40 homeruns but less than 60 strikeouts.

```{r}
query<- "SELECT playerID,HR,SO,teamID,yearID
FROM Batting
WHERE HR>40 and SO<60"

sqldf(query)
```

1970s Phillies hitting more than 30 homeruns.

```{r}
query<-"SELECT playerID,HR,yearID
FROM Batting
WHERE teamID='PHI'and HR>30 and yearID>=1970 and yearID<=1979"

sqldf(query)
```

## ORDER BY

## AGGREGATION

## JOINING

Find all instances where Babe Ruth hit homeruns with full name instead of teamID.
```{r}
query<-"SELECT playerID,name, Batting.yearID, Batting.HR
FROM Batting INNER JOIN Teams
ON Batting.teamID=Teams.teamID and Batting.yearID=Teams.yearID
WHERE playerID='ruthba01'"

sqldf(query)


```

Find career homerun totals for players who have at least 600 homeruns. Display from the highest amount to the lowest, with first and last names.

```{r}
query<-"SELECT nameFIRST,nameLAST,sum(HR)
FROM Batting INNER JOIN Master 
ON Batting.playerID=Master.playerID
GROUP BY Batting.playerID
HAVING sum(HR)>=600
ORDER BY sum(HR) DESC"

sqldf(query)
```

